<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; drexml 1.0.0+editable documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Authors and contributors" href="authors-reference.html" />
    <link rel="prev" title="CLI Reference" href="cli-reference.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            drexml
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="cli-reference.html">CLI Reference</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-drexml.datasets">datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.fetch_file"><code class="docutils literal notranslate"><span class="pre">fetch_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.get_data"><code class="docutils literal notranslate"><span class="pre">get_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.get_disease_data"><code class="docutils literal notranslate"><span class="pre">get_disease_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.get_gda"><code class="docutils literal notranslate"><span class="pre">get_gda()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.get_index_name_options"><code class="docutils literal notranslate"><span class="pre">get_index_name_options()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.load_atc"><code class="docutils literal notranslate"><span class="pre">load_atc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.load_df"><code class="docutils literal notranslate"><span class="pre">load_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.load_disgenet"><code class="docutils literal notranslate"><span class="pre">load_disgenet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.load_drugbank"><code class="docutils literal notranslate"><span class="pre">load_drugbank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.load_physiological_circuits"><code class="docutils literal notranslate"><span class="pre">load_physiological_circuits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.preprocess_activities"><code class="docutils literal notranslate"><span class="pre">preprocess_activities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.preprocess_frame"><code class="docutils literal notranslate"><span class="pre">preprocess_frame()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.preprocess_genes"><code class="docutils literal notranslate"><span class="pre">preprocess_genes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.preprocess_gexp"><code class="docutils literal notranslate"><span class="pre">preprocess_gexp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.datasets.preprocess_map"><code class="docutils literal notranslate"><span class="pre">preprocess_map()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-drexml.models">models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#drexml.models.get_model"><code class="docutils literal notranslate"><span class="pre">get_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-drexml.pystab">pystab</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#drexml.pystab.NogueiraTest"><code class="docutils literal notranslate"><span class="pre">NogueiraTest</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#drexml.pystab.NogueiraTest.alpha"><code class="docutils literal notranslate"><span class="pre">NogueiraTest.alpha</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.pystab.NogueiraTest.error"><code class="docutils literal notranslate"><span class="pre">NogueiraTest.error</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.pystab.NogueiraTest.estimator"><code class="docutils literal notranslate"><span class="pre">NogueiraTest.estimator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.pystab.NogueiraTest.lower"><code class="docutils literal notranslate"><span class="pre">NogueiraTest.lower</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.pystab.NogueiraTest.upper"><code class="docutils literal notranslate"><span class="pre">NogueiraTest.upper</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.pystab.NogueiraTest.var"><code class="docutils literal notranslate"><span class="pre">NogueiraTest.var</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.pystab.fdr"><code class="docutils literal notranslate"><span class="pre">fdr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.pystab.nogueria_test"><code class="docutils literal notranslate"><span class="pre">nogueria_test()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-drexml.explain">explain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.build_stability_dict"><code class="docutils literal notranslate"><span class="pre">build_stability_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.compute_corr_sign"><code class="docutils literal notranslate"><span class="pre">compute_corr_sign()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.compute_shap_fs"><code class="docutils literal notranslate"><span class="pre">compute_shap_fs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.compute_shap_relevance"><code class="docutils literal notranslate"><span class="pre">compute_shap_relevance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.compute_shap_values_"><code class="docutils literal notranslate"><span class="pre">compute_shap_values_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.get_quantile_by_circuit"><code class="docutils literal notranslate"><span class="pre">get_quantile_by_circuit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.explain.matcorr"><code class="docutils literal notranslate"><span class="pre">matcorr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-drexml.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.build_circuits_fname"><code class="docutils literal notranslate"><span class="pre">build_circuits_fname()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.build_gene_exp_fname"><code class="docutils literal notranslate"><span class="pre">build_gene_exp_fname()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.build_genes_fname"><code class="docutils literal notranslate"><span class="pre">build_genes_fname()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.build_pathvals_fname"><code class="docutils literal notranslate"><span class="pre">build_pathvals_fname()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.check_cli_arg_is_bool"><code class="docutils literal notranslate"><span class="pre">check_cli_arg_is_bool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.check_gputree_availability"><code class="docutils literal notranslate"><span class="pre">check_gputree_availability()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.convert_names"><code class="docutils literal notranslate"><span class="pre">convert_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.ensure_zenodo"><code class="docutils literal notranslate"><span class="pre">ensure_zenodo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_cuda_lib"><code class="docutils literal notranslate"><span class="pre">get_cuda_lib()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_cuda_version"><code class="docutils literal notranslate"><span class="pre">get_cuda_version()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_latest_record"><code class="docutils literal notranslate"><span class="pre">get_latest_record()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_number_cuda_devices"><code class="docutils literal notranslate"><span class="pre">get_number_cuda_devices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_number_cuda_devices_"><code class="docutils literal notranslate"><span class="pre">get_number_cuda_devices_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_out_path"><code class="docutils literal notranslate"><span class="pre">get_out_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_resource_path"><code class="docutils literal notranslate"><span class="pre">get_resource_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_stab"><code class="docutils literal notranslate"><span class="pre">get_stab()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.get_version"><code class="docutils literal notranslate"><span class="pre">get_version()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.parse_stab"><code class="docutils literal notranslate"><span class="pre">parse_stab()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_activity_normalizer"><code class="docutils literal notranslate"><span class="pre">read_activity_normalizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_circuits_column"><code class="docutils literal notranslate"><span class="pre">read_circuits_column()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_disease_config"><code class="docutils literal notranslate"><span class="pre">read_disease_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_disease_id"><code class="docutils literal notranslate"><span class="pre">read_disease_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_path_based"><code class="docutils literal notranslate"><span class="pre">read_path_based()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_seed_genes"><code class="docutils literal notranslate"><span class="pre">read_seed_genes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_use_physio"><code class="docutils literal notranslate"><span class="pre">read_use_physio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.read_version_based"><code class="docutils literal notranslate"><span class="pre">read_version_based()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.update_circuits"><code class="docutils literal notranslate"><span class="pre">update_circuits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.update_gene_exp"><code class="docutils literal notranslate"><span class="pre">update_gene_exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.update_genes"><code class="docutils literal notranslate"><span class="pre">update_genes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#drexml.utils.update_pathvals"><code class="docutils literal notranslate"><span class="pre">update_pathvals()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-drexml.plotting">plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#drexml.plotting.RepurposingResult"><code class="docutils literal notranslate"><span class="pre">RepurposingResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.filter_scores"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.filter_scores()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.get_stable_circuits"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.get_stable_circuits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.plot_gene_profile"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.plot_gene_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.plot_metrics"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.plot_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.plot_relevance_heatmap"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.plot_relevance_heatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.score_mat"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.score_mat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.sel_mat"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.sel_mat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#drexml.plotting.RepurposingResult.stab_mat"><code class="docutils literal notranslate"><span class="pre">RepurposingResult.stab_mat</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cli-reference.html">CLI Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors-reference.html">Authors and contributors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">drexml</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api_reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<span id="id1"></span><h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h1>
<section id="module-drexml.datasets">
<span id="datasets"></span><h2>datasets<a class="headerlink" href="#module-drexml.datasets" title="Permalink to this heading"></a></h2>
<p>IO module for DREXML.</p>
<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.fetch_file">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">fetch_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.fetch_file" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve file from the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – Key of the file to retrieve.</p></li>
<li><p><strong>env</strong> (<em>dict</em>) – Environment.</p></li>
<li><p><strong>version</strong> (<em>str</em>) – Version of the file to retrieve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Not implemented yet.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.get_data">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disease</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Load disease data and metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>disease</strong> (<em>path-like</em>) – Path to disease config file.</p></li>
<li><p><strong>debug</strong> (<em>bool</em>) – _description_, by default False.</p></li>
<li><p><strong>scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – _description_, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pandas.DataFrame</em> – Gene expression data.</p></li>
<li><p><em>pandas.DataFrame</em> – Circuit activation data (hipathia).</p></li>
<li><p><em>pandas.DataFrame</em> – Circuit definition binary matrix.</p></li>
<li><p><em>pandas.DataFrame</em> – KDT definition binary matrix.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.get_disease_data">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">get_disease_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disease</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.get_disease_data" title="Permalink to this definition"></a></dt>
<dd><p>Get data for a disease.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>disease</strong> (<em>pathlib.Path</em>) – Path to the disease configuration file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>pandas.DataFrame</em> – Gene expression data.</p></li>
<li><p><em>pandas.DataFrame</em> – Circuit activation data (hipathia).</p></li>
<li><p><em>pandas.DataFrame</em> – Circuit definition binary matrix.</p></li>
<li><p><em>pandas.DataFrame</em> – KDT definition binary matrix.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.get_gda">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">get_gda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disease_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.get_gda" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the list of genes associated to a disese according to the Disgenet
curated list of gene-disease associations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>disease_id</strong> (<em>str</em>) – Disease ID.</p></li>
<li><p><strong>k_top</strong> (<em>int</em>) – Retrieve at most k_top genes based on the GDA score.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of gene IDs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.get_index_name_options">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">get_index_name_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.get_index_name_options" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of possible index names based on the input key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – The key for the data frame.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of possible index names based on the input key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_index_name_options</span><span class="p">(</span><span class="s2">&quot;circuits&quot;</span><span class="p">)</span>
<span class="go">[&quot;hipathia_id&quot;, &quot;hipathia&quot;, &quot;circuits_id&quot;, &quot;index&quot;]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This function returns a list of possible index names based on the input key. If the
key is “circuits”, it returns a list of four possible index names. If the key is
“genes”, it returns a list of three possible index names. Otherwise, it returns a
list with only one element, “index”.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.load_atc">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">load_atc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.load_atc" title="Permalink to this definition"></a></dt>
<dd><p>Load the ATC table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ATC table.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.load_df">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">load_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.load_df" title="Permalink to this definition"></a></dt>
<dd><p>Load dataframe from file. At the moment: stv, tsv crompressed or feather.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>pathlib.Path</em>) – Path to file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Not implemented yet.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.load_disgenet">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">load_disgenet</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.load_disgenet" title="Permalink to this definition"></a></dt>
<dd><p>Download if necessary and load the Disgenet curated list of gene-disease
associations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Disgenet curated dataset of gene-disease associations.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.load_drugbank">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">load_drugbank</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.load_drugbank" title="Permalink to this definition"></a></dt>
<dd><p>Download if necessary and load the drugbank table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Drugbank table.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.load_physiological_circuits">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">load_physiological_circuits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.load_physiological_circuits" title="Permalink to this definition"></a></dt>
<dd><p>Load the list of physiological circuits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of physiological circuit IDs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.preprocess_activities">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">preprocess_activities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.preprocess_activities" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses an activities data frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>pandas.DataFrame</em>) – The activities data frame to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed activities data frame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;-&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Activity 1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preprocess_activities</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   .  Activity.1</span>
<span class="go">0  1          3</span>
<span class="go">1  2          4</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This function replaces hyphens and spaces in the column names of the input data
frame with periods and returns the resulting data frame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.preprocess_frame">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">preprocess_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.preprocess_frame" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses the input data frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>pandas.DataFrame</em>) – The input data frame.</p></li>
<li><p><strong>env</strong> (<em>dict</em>) – The environment variables.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – The key for the data frame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed data frame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.preprocess_genes">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">preprocess_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes_column</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.preprocess_genes" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses a gene expression data frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>pandas.DataFrame</em>) – The gene expression data frame to preprocess.</p></li>
<li><p><strong>genes_column</strong> (<em>str</em>) – The name of the column containing gene information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed gene expression data frame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Gene&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preprocess_genes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;Gene&quot;</span><span class="p">)</span>
<span class="go">  Gene  Value</span>
<span class="go">0    A      1</span>
<span class="go">1    B      2</span>
<span class="go">2    C      3</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This function selects rows from the input data frame based on the values in the
specified genes column and returns the resulting data frame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.preprocess_gexp">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">preprocess_gexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.preprocess_gexp" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses a gene expression data frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>pandas.DataFrame</em>) – The gene expression data frame to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed gene expression data frame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;X1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;X2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preprocess_gexp</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   1  2</span>
<span class="go">0  1  3</span>
<span class="go">1  2  4</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This function removes the “X” prefix from the column names of the input data frame
and returns the resulting data frame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.datasets.preprocess_map">
<span class="sig-prename descclassname"><span class="pre">drexml.datasets.</span></span><span class="sig-name descname"><span class="pre">preprocess_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disease_seed_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circuits_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_physio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circuits_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.datasets.preprocess_map" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses a map data frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>pandas.DataFrame</em>) – The map data frame to preprocess.</p></li>
<li><p><strong>disease_seed_genes</strong> (<em>str</em>) – The comma separated list of disease seed genes.</p></li>
<li><p><strong>circuits_column</strong> (<em>str</em>) – The name of the column containing circuit information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of circuits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;in_disease&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;hipathia&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preprocess_map</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A,B&quot;</span><span class="p">,</span> <span class="s2">&quot;in_disease&quot;</span><span class="p">)</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>This function replaces hyphens and spaces in the index names of the input data frame</dt><dd><p>with periods and returns the resulting list of circuits.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-drexml.models">
<span id="models"></span><h2>models<a class="headerlink" href="#module-drexml.models" title="Permalink to this heading"></a></h2>
<p>Model definition.</p>
<dl class="py function">
<dt class="sig sig-object py" id="drexml.models.get_model">
<span class="sig-prename descclassname"><span class="pre">drexml.models.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.models.get_model" title="Permalink to this definition"></a></dt>
<dd><p>Create a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features (KDTs).</p></li>
<li><p><strong>n_targets</strong> (<em>int</em>) – Number of targets (circuits).</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – The number of jobs to run in parallel.</p></li>
<li><p><strong>debug</strong> (<em>bool</em>) – Debug flag.</p></li>
<li><p><strong>n_iters</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of ietrations for hyperparatemer optimization, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model to be fitted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sklearn.ensemble.RandomForestRegressor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-drexml.pystab">
<span id="pystab"></span><h2>pystab<a class="headerlink" href="#module-drexml.pystab" title="Permalink to this heading"></a></h2>
<p>Implementation of Nogueira’s stability measure. See:
[1] S. Nogueira, K. Sechidis, and G. Brown, “On the Stability of Feature Selection
Algorithms,” Journal of Machine Learning Research, vol. 18, no. 174, pp. 1–54, 2018.</p>
<dl class="py class">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drexml.pystab.</span></span><span class="sig-name descname"><span class="pre">NogueiraTest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.pystab.NogueiraTest" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#drexml.pystab.NogueiraTest.alpha" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest.error">
<span class="sig-name descname"><span class="pre">error</span></span><a class="headerlink" href="#drexml.pystab.NogueiraTest.error" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest.estimator">
<span class="sig-name descname"><span class="pre">estimator</span></span><a class="headerlink" href="#drexml.pystab.NogueiraTest.estimator" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest.lower">
<span class="sig-name descname"><span class="pre">lower</span></span><a class="headerlink" href="#drexml.pystab.NogueiraTest.lower" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest.upper">
<span class="sig-name descname"><span class="pre">upper</span></span><a class="headerlink" href="#drexml.pystab.NogueiraTest.upper" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.pystab.NogueiraTest.var">
<span class="sig-name descname"><span class="pre">var</span></span><a class="headerlink" href="#drexml.pystab.NogueiraTest.var" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.pystab.fdr">
<span class="sig-prename descclassname"><span class="pre">drexml.pystab.</span></span><span class="sig-name descname"><span class="pre">fdr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_vals</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.pystab.fdr" title="Permalink to this definition"></a></dt>
<dd><p>False Discovery Rate p values adjustment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p_vals</strong> (<em>array like</em><em> (</em><em>n_runs</em><em>, </em><em>)</em>) – The list of p values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FDR-adjusted p values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array (n_runs, )</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.pystab.nogueria_test">
<span class="sig-prename descclassname"><span class="pre">drexml.pystab.</span></span><span class="sig-name descname"><span class="pre">nogueria_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.pystab.nogueria_test" title="Permalink to this definition"></a></dt>
<dd><p>Let X be a feature space of dimension <cite>n_features</cite> and <cite>pop_mat</cite> a binary matrix
of dimension <cite>(n_samples, n_festures)</cite> representing <cite>n_samples</cite> runs of a feature
selection algorithm over X (with respect to a response). This function computes the
Nogueira stability estimate, error, variance and confindece interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pop_mat</strong> (<em>2d-array like</em>) – A (n_samples, n_features) binary matrix, each row is a sample of the FS
algorithm applied on a n_features space, where a 1 in position (i,j) means that
the feature j has been selected for the i-th run.</p></li>
<li><p><strong>alpha</strong> (<em>scalar</em>) – Level of significance for the CI.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A named tuple with the results of the stability test.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#drexml.pystab.NogueiraTest" title="drexml.pystab.NogueiraTest">NogueiraTest</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-drexml.explain">
<span id="explain"></span><h2>explain<a class="headerlink" href="#module-drexml.explain" title="Permalink to this heading"></a></h2>
<p>Explainability module for multi-task framework.</p>
<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.build_stability_dict">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">build_stability_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.build_stability_dict" title="Permalink to this definition"></a></dt>
<dd><p>Adapt NogueiraTest to old version of drexml (use dicts).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_mat</strong> (<em>ndarray</em><em> [</em><em>n_model_samples</em><em>, </em><em>n_features</em><em>]</em>) – The stability matrix.</p></li>
<li><p><strong>scores</strong> (<em>ndarray</em><em> [</em><em>n_model_samples</em><em>]</em>) – The metric scores over the test sets.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Signficance level for Nogueira’s test, by default 0.05</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the Nogueira test results and test metric scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.compute_corr_sign">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">compute_corr_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.compute_corr_sign" title="Permalink to this definition"></a></dt>
<dd><p>Coompute the correlation sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> [</em><em>n_samples</em><em>, </em><em>n_features</em><em>]</em>) – The feature dataset.</p></li>
<li><p><strong>y</strong> (<em>ndarray</em><em> [</em><em>n_samples</em><em>, </em><em>n_tasks</em><em>]</em>) – The task dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SHAP feature-task (linear) interaction sign.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray [n_features, n_tasks]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.compute_shap_fs">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">compute_shap_fs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relevances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_circuit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.compute_shap_fs" title="Permalink to this definition"></a></dt>
<dd><p>Compute the feature selection scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relevances</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_features</em><em>, </em><em>n_tasks</em><em>]</em>) – The relevance scores.</p></li>
<li><p><strong>model</strong> (<em>sklearn.base.BaseEstimator</em><em>, </em><em>optional</em>) – The model to explain the data.</p></li>
<li><p><strong>X</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_samples</em><em>, </em><em>n_features</em><em>]</em><em>, </em><em>optional</em>) – The feature dataset to explain, by default None.</p></li>
<li><p><strong>Y</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_samples</em><em>, </em><em>n_tasks</em><em>]</em><em>, </em><em>optional</em>) – The task dataset to explain, by default None</p></li>
<li><p><strong>q</strong> (<em>float</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Either a metric string to discriminate fs tasks or predefined quantile, by
default “r2”</p></li>
<li><p><strong>by_circuit</strong> (<em>bool</em><em>, </em><em>optional</em>) – Feature selection by circuit or globally, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The feature selection scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.Series [n_features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.compute_shap_relevance">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">compute_shap_relevance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shap_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.compute_shap_relevance" title="Permalink to this definition"></a></dt>
<dd><p>Convert the SHAP values to relevance scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shap_values</strong> (<em>ndarray</em><em> [</em><em>n_samples_new</em><em>, </em><em>n_features</em><em>, </em><em>n_tasks</em><em>]</em>) – The SHAP values.</p></li>
<li><p><strong>X</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_samples</em><em>, </em><em>n_features</em><em>]</em>) – The feature dataset to explain.</p></li>
<li><p><strong>Y</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_samples</em><em>, </em><em>n_tasks</em><em>]</em>) – The task dataset to explain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The task-wise feature relevance scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame [n_features, n_tasks]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.compute_shap_values_">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">compute_shap_values_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_add</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.compute_shap_values_" title="Permalink to this definition"></a></dt>
<dd><p>Partial function to compute the SHAP values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> [</em><em>n_samples</em><em>, </em><em>n_features</em><em>]</em>) – The feature dataset.</p></li>
<li><p><strong>explainer</strong> (<em>shap.TreeExplainer</em><em> or </em><em>shap.GPUTreeExplainer</em>) – The SHAP explainer.</p></li>
<li><p><strong>check_add</strong> (<em>bool</em>) – Check if the SHAP values add up to the model output.</p></li>
<li><p><strong>gpu_id</strong> (<em>int</em>) – The GPU ID.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>shap_values</strong> – The SHAP values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray [n_samples, n_features, n_tasks]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.get_quantile_by_circuit">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">get_quantile_by_circuit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.get_quantile_by_circuit" title="Permalink to this definition"></a></dt>
<dd><p>Get the selection quantile of the model by circuit (or globally). Select features
whose relevance score is above said quantile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>sklearn.base.BaseEstimator</em>) – Fited model.</p></li>
<li><p><strong>X</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_samples</em><em>, </em><em>n_features</em><em>]</em>) – The feature dataset to explain.</p></li>
<li><p><strong>Y</strong> (<em>pandas.DataFrame</em><em> [</em><em>n_samples</em><em>, </em><em>n_tasks</em><em>]</em>) – The task dataset to explain.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Theshold to use to dicriminate ill-conditioned circuits when performing feature
selection, by default 0.5</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Qauntile to use.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.explain.matcorr">
<span class="sig-prename descclassname"><span class="pre">drexml.explain.</span></span><span class="sig-name descname"><span class="pre">matcorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.explain.matcorr" title="Permalink to this definition"></a></dt>
<dd><p>Fast correlation matrix computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>ndarray</em><em> [</em><em>n_samples</em><em>, </em><em>n_features</em><em>]</em>) – A matrix of observations.</p></li>
<li><p><strong>targets</strong> (<em>ndarray</em><em> [</em><em>n_samples</em><em>, </em><em>n_tasks</em><em>]</em>) – A matrix of predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The correlation matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-drexml.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-drexml.utils" title="Permalink to this heading"></a></h2>
<p>Utilities module.</p>
<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.build_circuits_fname">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">build_circuits_fname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.build_circuits_fname" title="Permalink to this definition"></a></dt>
<dd><p>Build circuits filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.build_gene_exp_fname">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">build_gene_exp_fname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.build_gene_exp_fname" title="Permalink to this definition"></a></dt>
<dd><p>Build gene_exp filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.build_genes_fname">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">build_genes_fname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.build_genes_fname" title="Permalink to this definition"></a></dt>
<dd><p>Build genes filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.build_pathvals_fname">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">build_pathvals_fname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.build_pathvals_fname" title="Permalink to this definition"></a></dt>
<dd><p>Build pathvals filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.check_cli_arg_is_bool">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">check_cli_arg_is_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.check_cli_arg_is_bool" title="Permalink to this definition"></a></dt>
<dd><p>Check if argument is a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>str</em>) – Argument.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.check_gputree_availability">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">check_gputree_availability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.check_gputree_availability" title="Permalink to this definition"></a></dt>
<dd><p>Check if GPUTree has been corectly compiled.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.convert_names">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">convert_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.convert_names" title="Permalink to this definition"></a></dt>
<dd><p>Convert names in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>pandas.DataFrame</em>) – Dataset.</p></li>
<li><p><strong>keys</strong> (<em>list</em>) – List of keys.</p></li>
<li><p><strong>axis</strong> (<em>list</em>) – List of axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>panda.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If key is not supported.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;circuits&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;C2&quot;</span><span class="p">],</span> <span class="s2">&quot;genes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;circuits&quot;</span><span class="p">,</span> <span class="s2">&quot;genes&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_names</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="go">   circuits  genes</span>
<span class="go">0        C1      1</span>
<span class="go">1        C2      2</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;circuits&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;C2&quot;</span><span class="p">],</span> <span class="s2">&quot;genes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;circuits&quot;</span><span class="p">,</span> <span class="s2">&quot;genes&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_names</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="go">   circuits  genes</span>
<span class="go">0        C1      1</span>
<span class="go">1        C2      2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.ensure_zenodo">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_zenodo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'6020480'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.ensure_zenodo" title="Permalink to this definition"></a></dt>
<dd><p>Ensure file availability and download it from zenodo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>record_id</strong> (<em>str</em>) – deposition identifier</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>path</strong> – PosixPath to downloaded file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>path-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_cuda_lib">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_cuda_lib</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_cuda_lib" title="Permalink to this definition"></a></dt>
<dd><p>Get CUDA library name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_cuda_version">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_cuda_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_cuda_version" title="Permalink to this definition"></a></dt>
<dd><p>Get CUDA version.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_latest_record">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_latest_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_latest_record" title="Permalink to this definition"></a></dt>
<dd><p>Get latest zenodo record ID from a given deposition identifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>record_id</strong> (<em>str</em>) – deposition identifier</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>latest record ID</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_number_cuda_devices">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_number_cuda_devices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_number_cuda_devices" title="Permalink to this definition"></a></dt>
<dd><p>Get number of CUDA devices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_number_cuda_devices_">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_number_cuda_devices_</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_number_cuda_devices_" title="Permalink to this definition"></a></dt>
<dd><p>Get number of CUDA devices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_out_path">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_out_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disease</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_out_path" title="Permalink to this definition"></a></dt>
<dd><p>Construct the path where the model must be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The desired path.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_resource_path">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_resource_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_resource_path" title="Permalink to this definition"></a></dt>
<dd><p>Get path to example disease env path.
:returns: Path to file.
:rtype: pathlib.PosixPath</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_stab">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_stab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_splits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_stab" title="Permalink to this definition"></a></dt>
<dd><p>Get stab data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_folder</strong> (<em>path-like</em>) – Path to data folder.</p></li>
<li><p><strong>n_splits</strong> (<em>int</em>) – Number of splits.</p></li>
<li><p><strong>n_cpus</strong> (<em>int</em>) – Number of CPUs.</p></li>
<li><p><strong>debug</strong> (<em>bool</em>) – Debug flag, by default False.</p></li>
<li><p><strong>n_iters</strong> (<em>int</em>) – Number of hyperparemeter optimization iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>drexml.models.Model</em> – Model.</p></li>
<li><p><em>list</em> – List of splits.</p></li>
<li><p><em>panda.DataFrame</em> – Gene expression data.</p></li>
<li><p><em>panda.DataFrame</em> – Circuit activation data (hipathia).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.get_version">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">get_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.get_version" title="Permalink to this definition"></a></dt>
<dd><p>Get drexml version.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.parse_stab">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">parse_stab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.parse_stab" title="Permalink to this definition"></a></dt>
<dd><p>Parse stab arguments.
:param argv: List of arguments.
:type argv: list</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>path-like</em> – Path to data folder.</p></li>
<li><p><em>int</em> – Number of hyperparameter optimizations.</p></li>
<li><p><em>int</em> – Number of GPUs.</p></li>
<li><p><em>int</em> – Number of CPUs.</p></li>
<li><p><em>int</em> – Number of splits.</p></li>
<li><p><em>bool</em> – Debug flag.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_activity_normalizer">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_activity_normalizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_activity_normalizer" title="Permalink to this definition"></a></dt>
<dd><p>Read activity_normalizer from config file. It expects a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Parsed config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_circuits_column">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_circuits_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_circuits_column" title="Permalink to this definition"></a></dt>
<dd><p>Read circuits column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_disease_config">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_disease_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disease</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_disease_config" title="Permalink to this definition"></a></dt>
<dd><p>Read disease config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>disease</strong> (<em>str</em>) – Path to disease config file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Config dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_disease_id">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_disease_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_disease_id" title="Permalink to this definition"></a></dt>
<dd><p>Read disease id from config file. It expects a disease id using the UMLS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Parsed config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_path_based">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_path_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_path_based" title="Permalink to this definition"></a></dt>
<dd><p>Read path based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dict</em>) – Config dict.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – Key in config dict.</p></li>
<li><p><strong>data_path</strong> (<em>path-like</em>) – Storage path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raise error if key is not present in config dict.</p></li>
<li><p><strong>FileNotFoundError</strong> – Raise error if path does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_seed_genes">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_seed_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_seed_genes" title="Permalink to this definition"></a></dt>
<dd><p>Read seed genes from config file. It expect a comma-separated list of entrez ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Parsed config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated conig dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_use_physio">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_use_physio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_use_physio" title="Permalink to this definition"></a></dt>
<dd><p>Read use_physio from config file. It expects a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Parsed config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.read_version_based">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">read_version_based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.read_version_based" title="Permalink to this definition"></a></dt>
<dd><p>Read version based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dict</em>) – Config dict.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – Key in config dict.</p></li>
<li><p><strong>version_dict</strong> (<em>dict</em>) – Version dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.update_circuits">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">update_circuits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.update_circuits" title="Permalink to this definition"></a></dt>
<dd><p>Update circuits key from config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If circuits is not provided, it will be built from the other keys.</p>
<p>If circuits is provided, it will be checked if it is a path.</p>
<p>If circuits is a path, it will be checked if it is a zenodo resource.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.update_gene_exp">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">update_gene_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.update_gene_exp" title="Permalink to this definition"></a></dt>
<dd><p>Update gene_exp key from config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If gene_exp is not provided, it will be built from the other keys.</p>
<p>If gene_exp is provided, it will be checked if it is a path.</p>
<p>If gene_exp is a path, it will be checked if it is a zenodo resource.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.update_genes">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">update_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.update_genes" title="Permalink to this definition"></a></dt>
<dd><p>Update genes key from config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If genes is not provided, it will be built from the other keys.</p>
<p>If genes is provided, it will be checked if it is a path.</p>
<p>If genes is a path, it will be checked if it is a zenodo resource.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drexml.utils.update_pathvals">
<span class="sig-prename descclassname"><span class="pre">drexml.utils.</span></span><span class="sig-name descname"><span class="pre">update_pathvals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.utils.update_pathvals" title="Permalink to this definition"></a></dt>
<dd><p>Update pathvals key from config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dict</em>) – Config dict.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated config dict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raise error if format is unsupported.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If pathvals is not provided, it will be built from the other keys.</p>
<p>If pathvals is provided, it will be checked if it is a path.</p>
<p>If pathvals is a path, it will be checked if it is a zenodo resource.</p>
</dd></dl>

</section>
<section id="module-drexml.plotting">
<span id="plotting"></span><h2>plotting<a class="headerlink" href="#module-drexml.plotting" title="Permalink to this heading"></a></h2>
<p>Plotting module for DREXML.</p>
<dl class="py class">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drexml.plotting.</span></span><span class="sig-name descname"><span class="pre">RepurposingResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sel_mat:</span> <span class="pre">pandas.core.frame.DataFrame</span> <span class="pre">|</span> <span class="pre">pathlib.Path</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_mat:</span> <span class="pre">pandas.core.frame.DataFrame</span> <span class="pre">|</span> <span class="pre">pathlib.Path</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stab_mat:</span> <span class="pre">pandas.core.frame.DataFrame</span> <span class="pre">|</span> <span class="pre">pathlib.Path</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.plotting.RepurposingResult" title="Permalink to this definition"></a></dt>
<dd><p>Class for storing the results of the DREXML analysis.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.filter_scores">
<span class="sig-name descname"><span class="pre">filter_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">remove_unstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.plotting.RepurposingResult.filter_scores" title="Permalink to this definition"></a></dt>
<dd><p>Filter the scores to only the selected genes and stable circuits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>remove_unstable</strong> (<em>bool</em><em>, </em><em>optional</em>) – Remove unstable circuits, by default True</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores_filt</strong> – Filtered scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.get_stable_circuits">
<span class="sig-name descname"><span class="pre">get_stable_circuits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#drexml.plotting.RepurposingResult.get_stable_circuits" title="Permalink to this definition"></a></dt>
<dd><p>Get the stable circuits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stable_circuits</strong> – List of stable circuits.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.plot_gene_profile">
<span class="sig-name descname"><span class="pre">plot_gene_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.plotting.RepurposingResult.plot_gene_profile" title="Permalink to this definition"></a></dt>
<dd><p>Plot the gene profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene</strong> (<em>str</em>) – Gene name.</p></li>
<li><p><strong>output_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Output folder, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.plot_metrics">
<span class="sig-name descname"><span class="pre">plot_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.735</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.plotting.RepurposingResult.plot_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Read the drexml results TSV file and plot it. The R^2 confidence interval for the
mean go to y-axis, whereas the x-axis shows the 95% interval for the Nogueiras’s
stability stimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of the plot.</p></li>
<li><p><strong>output_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the output folder. If None, the output folder is the same
as the input folder.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.plot_relevance_heatmap">
<span class="sig-name descname"><span class="pre">plot_relevance_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">remove_unstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#drexml.plotting.RepurposingResult.plot_relevance_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>Plot the relevance heatmap of the scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>remove_unstable</strong> (<em>bool</em><em>, </em><em>optional</em>) – Remove unstable circuits, by default True</p></li>
<li><p><strong>output_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Output folder, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.score_mat">
<span class="sig-name descname"><span class="pre">score_mat</span></span><a class="headerlink" href="#drexml.plotting.RepurposingResult.score_mat" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.sel_mat">
<span class="sig-name descname"><span class="pre">sel_mat</span></span><a class="headerlink" href="#drexml.plotting.RepurposingResult.sel_mat" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drexml.plotting.RepurposingResult.stab_mat">
<span class="sig-name descname"><span class="pre">stab_mat</span></span><a class="headerlink" href="#drexml.plotting.RepurposingResult.stab_mat" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cli-reference.html" class="btn btn-neutral float-left" title="CLI Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="authors-reference.html" class="btn btn-neutral float-right" title="Authors and contributors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Carlos Loucera.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>